---
import CommonLayout from '../layouts/CommonLayout.astro';
import '../styles/index.scss';
import Button from '../components/Button.astro';
import Person from '../components/people/Person.astro';

const { frontmatter } = Astro.props;
const { talkTitle, tracks, talkTags, org, talkLevel, talkDuration } =
  frontmatter;

const sep = /\/\/\/\/\/\/.*/;
const content = await Astro.slots.render('default');
const abstract = content.split(sep)[0];
const bio = content.split(sep)[1].replace(/^\n|\n$/g, '');
---

<CommonLayout title={talkTitle} withLogo>
  <div class="container text-center" slot="header">
    <div class="kicker">Talk</div>
    <h1>
      {talkTitle}
    </h1>
  </div>

  <section class="container md:grid md:cols-12 py-12">
    <div class="md:col-start-3 md:col-end-11">
      <!-- <slot /> -->
      <div set:html={abstract} />
      <div class="space-y-3">
        {
          talkLevel && (
            <Fragment>
              <strong>Audience:</strong> {talkLevel}
            </Fragment>
          )
        }
      </div>
      <div class="py-6">
        <h3>Talk by</h3>
        {
          frontmatter.speakers.map((speaker: any) => (
            <div class="speaker">
              <div>
                <Person {...speaker} />
              </div>
              <div class="bio">
                <div set:html={bio} />
                {speaker.title}
              </div>
            </div>
          ))
        }
        <Button
          link="https://www.eventbrite.nl/e/rustweek-2025-tickets-1001676961757?aff=oddtdtcreator"
        >
          Get your ticket
        </Button>
      </div>
    </div>
  </section>
</CommonLayout>

<style is:global>
.bio p {
    margin: 0;
    padding: 0;
    min-height: 0;
}
</style>

<style lang="scss">
@use '../styles/variables.scss';
@use '../styles/breakpoint.scss';

.speaker {
      border-bottom: 1px solid variables.$color-red-400;
      padding-bottom: 1.5rem;
      margin-bottom: 1.5rem;

      display: grid;
      grid-template-columns: 2fr 3fr;
      gap: 2em;

     @include breakpoint.smaller_than(lg) {
        display: flex;
        flex-direction: column;
     }
}

.bio {
    display: flex;
    flex-direction: column;
    gap: 2em;
}

.kicker {
  color: variables.$color-red-400;
  font-weight: 700;
  text-transform: uppercase;
}

h1 {
  padding: 0;
}
</style>
